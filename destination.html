<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Favorites - Travel Planner</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
<link rel="stylesheet" href="stylelfav.css" />
</head>
<body>
  <div class="header ">
       <nav>
        <div class="logo" aria-label="Travel Planner Logo with airplane icon">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true" role="img">
            <path d="M2.5 19.5 21 12 2.5 4.5v7.125L17.625 12 2.5 11.375v7.125z" />
        </svg>
        Travel Planner
        </div>
        <div class="links" role="navigation" aria-label="Primary site navigation">
        <a href="#" tabindex="0">Home</a>
        <a href="#" tabindex="0">Destinations</a>
        <a href="#" tabindex="0">My Trips</a>
        <a href="#" tabindex="0">Favorites</a>
        <button class="login-btn" aria-label="Login or Register button" tabindex="0">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true" role="img" style="width:16px; height:16px;">
            <path d="M10 17l5-5-5-5M15 12H3" />
            </svg>
            Login/Register
        </button>
        </div>
    </nav>
    </div>

  <header class="page-header" role="banner" aria-label="Favorites page title and subtitle">
    <h1><i class="bi bi-heart-fill" aria-hidden="true"></i> My Favorites</h1>
    <p>Save and organize your favorite destinations and trips</p>
  </header>
  <main class="favorites-container" role="main" aria-live="polite" aria-atomic="true" aria-relevant="additions removals">
    <div class="favorites-header">
      <h4><i class="bi bi-heart-fill"></i> Saved Favorites</h4>
      <div>
        <button id="addSampleBtn" class="btn btn-primary btn-sm" type="button" aria-label="Add sample favorite items">
          + Add Sample Items
        </button>
        <button id="clearAllBtn" class="btn btn-outline-danger btn-sm ms-2" type="button" aria-label="Clear all favorite items">
          <i class="bi bi-trash"></i> Clear All
        </button>
      </div>
    </div>

    <div id="favoritesList" class="row g-3" aria-live="polite" aria-atomic="true">
    </div>

    <div id="noFavoritesMessage" class="no-favorites d-none" role="region" aria-live="polite" aria-atomic="true">
      <i class="bi bi-heart" style="font-size:3.5rem; color:#888;"></i>
      <h3 class="mt-3">No favorites yet</h3>
      <p>Start exploring destinations and add them to your favorites to see them here.</p>
      <button id="exploreBtn" class="btn-explore" type="button" aria-label="Explore Destinations">
        <i class="bi bi-search me-2" aria-hidden="true"></i> Explore Destinations
      </button>
    </div>
  </main>

  <div class="modal fade" id="confirmRemoveModal" tabindex="-1" aria-labelledby="confirmRemoveLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header align-items-center">
          <i class="bi bi-exclamation-lg text-warning modal-icon" aria-hidden="true"></i>
          <h5 class="modal-title" id="confirmRemoveLabel">Remove Favorite?</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="modalCloseBtn"></button>
        </div>
        <div class="modal-body">
          Are you sure you want to remove this item from your favorites?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" id="modalConfirmBtn">Yes, remove it</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="removedSuccessModal" tabindex="-1" aria-labelledby="removedSuccessLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-success">
        <div class="modal-header align-items-center">
          <i class="bi bi-check-circle-fill text-success modal-icon" aria-hidden="true"></i>
          <h5 class="modal-title" id="removedSuccessLabel">Removed!</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="successModalCloseBtn"></button>
        </div>
        <div class="modal-body" id="removedSuccessMessage">
        
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="successOkBtn">OK</button>
        </div>
      </div>
    </div>
  </div>

  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
   
    let favoriteIDs = [];

    
    let apiData = null;

  
    const favoritesList = document.getElementById('favoritesList');
    const noFavoritesMessage = document.getElementById('noFavoritesMessage');
    const clearAllBtn = document.getElementById('clearAllBtn');
    const addSampleBtn = document.getElementById('addSampleBtn');
    const exploreBtn = document.getElementById('exploreBtn');

   
    const confirmRemoveModal = new bootstrap.Modal(document.getElementById('confirmRemoveModal'));
    const removedSuccessModal = new bootstrap.Modal(document.getElementById('removedSuccessModal'));
    const removedSuccessMessage = document.getElementById('removedSuccessMessage');
    const modalConfirmBtn = document.getElementById('modalConfirmBtn');

   
    let idToRemove = null;

    async function fetchApiData() {
      try {
        const response = await fetch('https://edu-me01.github.io/Traval-task/api/data.json');
        if (!response.ok) throw new Error('Network response was not OK');
        const data = await response.json();
        apiData = data;
      } catch (error) {
        console.error('Failed to fetch API data:', error);
        apiData = null;
      }
    }

    
    function getItemById(id) {
      if (!apiData || !apiData.destinations) return null;
      return apiData.destinations.find(item => item.id === id);
    }

    
    function renderFavorites() {
      favoritesList.innerHTML = '';

      if (favoriteIDs.length === 0) {
        noFavoritesMessage.classList.remove('d-none');
        clearAllBtn.disabled = true;
        addSampleBtn.disabled = false;
        return;
      }

      noFavoritesMessage.classList.add('d-none');
      clearAllBtn.disabled = false;
      addSampleBtn.disabled = false;

      favoriteIDs.forEach(id => {
        const item = getItemById(id);
        if (!item) return;

        
        const col = document.createElement('div');
        col.className = 'col-12 col-sm-6 col-md-4 col-lg-3';

       
        const card = document.createElement('div');
        card.className = 'card fav-card';
        card.setAttribute('tabindex', '0');
        card.setAttribute('role', 'article');
        card.setAttribute('aria-label', Favorite destination: ${item.city}, ${item.country});

       
        const img = document.createElement('img');
        img.src = item.banner;
        img.className = 'card-img-top fav-card-img';
        img.alt = View of ${item.city}, ${item.country} showing ${item.description ? item.description.slice(0, 40) : 'destination'};
        img.onerror = () => { img.src = 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/c64e4609-5eac-40aa-9e95-4ba2369be8bb.png'; };

        
        const removeBtn = document.createElement('button');
        removeBtn.type = 'button';
        removeBtn.className = 'remove-fav-btn';
        removeBtn.setAttribute('aria-label', Remove favorite ${item.city}, ${item.country});
        removeBtn.title = 'Remove favorite';
        removeBtn.innerHTML = '<i class="bi bi-x-lg" aria-hidden="true"></i>';
        removeBtn.addEventListener('click', () => promptRemoveFavorite(id));

        
        const cardBody = document.createElement('div');
        cardBody.className = 'card-body';

        const title = document.createElement('h5');
        title.className = 'card-title';
        title.textContent = ${item.city}, ${item.country};

        const desc = document.createElement('p');
        desc.className = 'card-text';
        desc.textContent = item.description ? item.description : 'No description available';

        const metaInfo = document.createElement('div');
        metaInfo.className = 'meta-info';

       
        const dateEl = document.createElement('small');
        dateEl.className = 'text-muted';
        const dateIcon = document.createElement('i');
        dateIcon.className = 'bi bi-calendar2-date me-1';
        dateIcon.setAttribute('aria-hidden', 'true');
        dateEl.appendChild(dateIcon);
        dateEl.appendChild(document.createTextNode(new Date(item.date).toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: 'numeric' })));

        const categoryEl = document.createElement('span');
        categoryEl.className = 'badge badge-category';
        const catIcon = document.createElement('i');
        catIcon.className = 'bi bi-geo-alt-fill me-1';
        catIcon.setAttribute('aria-hidden', 'true');
        categoryEl.appendChild(catIcon);
        categoryEl.appendChild(document.createTextNode(item.category));

        metaInfo.appendChild(dateEl);
        metaInfo.appendChild(categoryEl);

        const viewBtn = document.createElement('button');
        viewBtn.type = 'button';
        viewBtn.className = 'btn btn-sm btn-primary view-btn';
        viewBtn.textContent = 'View';
        viewBtn.setAttribute('aria-label', View details of ${item.city}, ${item.country});
        
        viewBtn.addEventListener('click', () => {
          alert(Viewing details for ${item.city}, ${item.country}\n\n${item.description});
        });

       
        cardBody.appendChild(title);
        cardBody.appendChild(desc);
        cardBody.appendChild(metaInfo);
        cardBody.appendChild(viewBtn);

       
        card.appendChild(img);
        card.appendChild(removeBtn);
        card.appendChild(cardBody);

       
        col.appendChild(card);
        favoritesList.appendChild(col);
      });
    }

    
    function promptRemoveFavorite(id) {
      idToRemove = id;
      confirmRemoveModal.show();
    }

    
    function confirmRemove() {
      if (idToRemove === null) return;
      const item = getItemById(idToRemove);
      if (!item) return;

     
      favoriteIDs = favoriteIDs.filter(i => i !== idToRemove);
      idToRemove = null;
      confirmRemoveModal.hide();

     
      removedSuccessMessage.textContent = ${item.city}, ${item.country} has been removed from your favorites.;
      removedSuccessModal.show();

      renderFavorites();
    }

    function clearAllFavorites() {
      if (favoriteIDs.length === 0) return;

      if (confirm('Are you sure you want to clear all favorites?')) {
        favoriteIDs = [];
        renderFavorites();
      }
    }

    
    function addSampleFavorites() {
      if (!apiData || !apiData.destinations) return;

      const sampleIds = apiData.destinations.slice(0, 5).map(item => item.id);
      favoriteIDs = [...new Set([...favoriteIDs, ...sampleIds])];
      renderFavorites();
    }

    
    exploreBtn.addEventListener('click', () => {
    
      alert('Redirecting to Destinations page...');
      
    });

    
    
    clearAllBtn.addEventListener('click', clearAllFavorites);
    addSampleBtn.addEventListener('click', addSampleFavorites);
    modalConfirmBtn.addEventListener('click', confirmRemove);


    (async () => {
      await fetchApiData();
      renderFavorites();
    })();
  </script>
</body>
</html>
